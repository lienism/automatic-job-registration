[
  {
    "Id": "739087",
    "ThreadId": "292214",
    "Html": "\r\n<p>Hi</p>\r\n<p>I added your wonderful scheduler to my windows application and it works perfect in Vista Home Edition development machine. The problem is, once I install or deploy the application to Windows XP professional box, NextRunTime comes up as NEVER! Please advise.\r\n Below is the code I used.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;&nbsp;&nbsp; // Get the service on the local machine<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (TaskService ts = new TaskService())<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Create a new task definition and assign properties<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TaskDefinition td = ts.NewTask();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; td.RegistrationInfo.Description = description;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; td.Settings.DeleteExpiredTaskAfter = new TimeSpan(7, 0, 0, 0, 0);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //td.Settings.RestartInterval = new TimeSpan(0, 3, 0); // throw exception with windows XP<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //td.Settings.RestartCount = 3;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; td.Settings.WakeToRun = true;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TimeTrigger trigger = new TimeTrigger();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trigger.StartBoundary = executionTime;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trigger.EndBoundary = executionTime.AddHours(1.0);<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; td.Triggers.Add(trigger);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string execFolder = &quot;C://Program Files/MegapixelsServer/MegapixelsScheduler.exe&quot;;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; td.Actions.Add(new ExecAction(execFolder, taskName, null));<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ts.RootFolder.RegisterTaskDefinition(taskName, td);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>\r\n",
    "PostedDate": "2012-02-03T23:46:29.8-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "740674",
    "ThreadId": "292214",
    "Html": "<p>I have tested this code and the only thing I can see that would be causing a problem is the initial value of 'executionTime'. Using DateTime.Now for that value works on my system. To deal with your commented out lines, you can use the following code.</p>\r\n<p>using (TaskService ts = new TaskService())<br />{<br />&nbsp;&nbsp;&nbsp; // Create a new task definition and assign properties<br />&nbsp;&nbsp;&nbsp; TaskDefinition td = ts.NewTask();<br />&nbsp;&nbsp;&nbsp; td.RegistrationInfo.Description = description;<br />&nbsp;&nbsp;&nbsp; td.Settings.DeleteExpiredTaskAfter = new TimeSpan(7, 0, 0, 0, 0);<br />&nbsp;&nbsp;&nbsp; if (ts.HighestSupportedVersion &gt;= new Version(1, 2))<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; td.Settings.RestartInterval = new TimeSpan(0, 3, 0);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; td.Settings.RestartCount = 3;<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; td.Settings.WakeToRun = true;<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; TimeTrigger trigger = new TimeTrigger();<br />&nbsp;&nbsp;&nbsp; trigger.StartBoundary = executionTime;<br />&nbsp;&nbsp;&nbsp; trigger.EndBoundary = executionTime.AddHours(1.0);</p>\r\n<p>&nbsp;&nbsp;&nbsp; td.Triggers.Add(trigger);<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; string execFolder = \"C://Program Files/MegapixelsServer/MegapixelsScheduler.exe\";<br />&nbsp;&nbsp;&nbsp; td.Actions.Add(new ExecAction(execFolder, taskName, null));</p>\r\n<p>&nbsp;&nbsp;&nbsp; ts.RootFolder.RegisterTaskDefinition(taskName, td);<br />}</p>",
    "PostedDate": "2012-02-04T21:22:02.887-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]