[
  {
    "Id": "461807",
    "ThreadId": "217896",
    "Html": "<p>Hello,<br>I found taskscheduler very useful but I'm having real hard-time trying to use the TaskschedulerEditor.<br>I&quot;m using XP SP3 32 bits and following the example posted here in the examples page:<br><br></p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:green\">// Get the service on the local machine</span>\r\n<span style=\"color:blue\">using</span> (TaskService ts = <span style=\"color:blue\">new</span> TaskService())\r\n{\r\n   <span style=\"color:green\">// Create a new task</span>\r\n   <span style=\"color:blue\">const</span> <span style=\"color:blue\">string</span> taskName = <span style=\"color:#a31515\">&quot;Test&quot;</span>;\r\n   Task t = ts.AddTask(taskName,\r\n      <span style=\"color:blue\">new</span> TimeTrigger() { StartBoundary = DateTime.Now + TimeSpan.FromHours(1), Enabled = <span style=\"color:blue\">false</span> },\r\n      <span style=\"color:blue\">new</span> ExecAction(<span style=\"color:#a31515\">&quot;notepad.exe&quot;</span>, <span style=\"color:#a31515\">&quot;c:\\\\test.log&quot;</span>, &quot;C:\\\\&quot;));\r\n\r\n   <span style=\"color:green\">// Edit task and re-register if user clicks Ok</span>\r\n   TaskEditDialog editorForm = <span style=\"color:blue\">new</span> TaskEditDialog();\r\n   editorForm.Editable = <span style=\"color:blue\">true</span>;\r\n   editorForm.Initialize(t);\r\n   <span style=\"color:blue\">if</span> (editorForm.ShowDialog() == System.Windows.Forms.DialogResult.OK)\r\n   {\r\n      ts.RootFolder.RegisterTaskDefinition(taskName, editorForm.TaskDefinition);\r\n   }\r\n\r\n   <span style=\"color:green\">// Remove the task we just created</span>\r\n   ts.RootFolder.DeleteTask(taskName);\r\n}\r\n</pre>\r\n</div>\r\n<p><br><br>and&nbsp;&nbsp;&nbsp;</p>\r\n<pre>editorForm.Initialize(t)</pre>\r\n<p>gives me this error:<br><br>-----------------------------------------------------------------------------------------------------------------------------------<br>System.NullReferenceException was unhandled<br>&nbsp; Message=&quot;Object reference not set to an instance of an object.&quot;<br>&nbsp; Source=&quot;Microsoft.Win32.TaskScheduler&quot;<br>&nbsp; StackTrace:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Win32.TaskScheduler.TaskService.ShouldSerializeUserName()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Win32.TaskScheduler.TaskService.get_UserName()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Win32.TaskScheduler.TaskPropertiesControl.set_TaskDefinition(TaskDefinition value)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Win32.TaskScheduler.TaskPropertiesControl.set_Task(Task value)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Win32.TaskScheduler.TaskPropertiesControl.Initialize(Task task)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Win32.TaskScheduler.TaskEditDialog.Initialize(Task task)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at test_taskeditor.Form1.button1_Click(Object sender, EventArgs e) in C:\\Users\\Administrator\\My Documents\\Visual Studio 2008\\Projects\\Testes\\test_taskeditor\\test_taskeditor\\Form1.cs:line 37<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnClick(EventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Button.OnClick(EventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.WndProc(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Button.WndProc(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG&amp; msg)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(Int32 dwComponentID, Int32 reason, Int32 pvLoopData)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.Run(Form mainForm)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at test_taskeditor.Program.Main() in C:\\Users\\Administrator\\My Documents\\Visual Studio 2008\\Projects\\Testes\\test_taskeditor\\test_taskeditor\\Program.cs:line 18<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart_Context(Object state)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart()<br>&nbsp; InnerException: <br><br>----------------------------------------------------------------------------------------------------------------------------------------------<br>By the way, I'm referencing Microsoft.Win32.TaskSchedulerEditor; as well and I'm able to do editorForm.Show() but it seems that the Task t lacks the UserAccountDomain. Look:</p>\r\n<p><a href=\"http://tinypic.com\"><img src=\"http://i50.tinypic.com/213n5mb.jpg\" border=0 alt=\"Image and video hosting by TinyPic\"></a></p>\r\n<p>I&quot;m using the1.5 Beta 2 release .<br><br>Thanks in advance...<br><br>Jose Luis</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-06-30T13:35:42.107-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "462405",
    "ThreadId": "217896",
    "Html": "<p>Found the solution myself:</p>\r\n<p>When instantiating a new taskService, I had to pass in the constructor: username, accountDomain, password and forceV1 = true</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-07-01T16:13:07.74-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "463244",
    "ThreadId": "217896",
    "Html": "<p>There was actually a bug in the Beta 2 release that caused this failure. Try the 1.5 Beta 3 code and remove the changes you made to the TaskService constructor.</p>",
    "PostedDate": "2010-07-04T08:27:25.437-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "463985",
    "ThreadId": "217896",
    "Html": "<p>Thanks for a quick reply Dahall, it is ok now :)</p>",
    "PostedDate": "2010-07-06T15:32:41.08-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]