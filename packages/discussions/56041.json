[
  {
    "Id": "189249",
    "ThreadId": "56041",
    "Html": "<p>Hello!</p>\r\n<div id=\"result_box\" style=\"text-align:left\" dir=ltr>I want to edit an existing task.</div>\r\n<div style=\"text-align:left\" dir=ltr>My code is:</div>\r\n<div style=\"text-align:left\" dir=ltr><span style=\"font-size:x-small\">&lt;font size=&quot;2&quot;&gt;\r\n<p>&nbsp;</p>\r\n&lt;/font&gt;</span>\r\n<p><span style=\"font-size:x-small;color:#0000ff\"><span style=\"font-size:x-small;color:#0000ff\">using</span></span><span style=\"font-size:x-small\"> (</span><span style=\"font-size:x-small;color:#2b91af\"><span style=\"font-size:x-small;color:#2b91af\">TaskService</span></span><span style=\"font-size:x-small\"> toTaskService = </span><span style=\"font-size:x-small;color:#0000ff\"><span style=\"font-size:x-small;color:#0000ff\">new</span></span><span style=\"font-size:x-small\"> </span><span style=\"font-size:x-small;color:#2b91af\"><span style=\"font-size:x-small;color:#2b91af\">TaskService</span></span><span style=\"font-size:x-small\">())\r\n<p>{</p>\r\n&lt;font size=&quot;2&quot;&gt;\r\n<p>&nbsp;</p>\r\n&lt;/font&gt;</span></p>\r\n<p><span style=\"font-size:x-small;color:#2b91af\"><span style=\"font-size:x-small;color:#2b91af\">Task</span></span><span style=\"font-size:x-small\"> gr1Task = toTaskService.GetTask(</span><span style=\"font-size:x-small;color:#a31515\"><span style=\"font-size:x-small;color:#a31515\">&quot;GR1&quot;</span></span><span style=\"font-size:x-small\">);</span></p>\r\n<span style=\"font-size:x-small\">&lt;font size=&quot;2&quot;&gt;\r\n<p>&nbsp;</p>\r\n&lt;/font&gt;</span>\r\n<p><span style=\"font-size:x-small;color:#2b91af\"><span style=\"font-size:x-small;color:#2b91af\">WeeklyTrigger</span></span><span style=\"font-size:x-small\"> trigger = </span><span style=\"font-size:x-small;color:#0000ff\"><span style=\"font-size:x-small;color:#0000ff\">new</span></span><span style=\"font-size:x-small\"> </span><span style=\"font-size:x-small;color:#2b91af\"><span style=\"font-size:x-small;color:#2b91af\">WeeklyTrigger</span></span><span style=\"font-size:x-small\">();&lt;font size=&quot;2&quot;&gt;\r\n<p>trigger.DaysOfWeek =</p>\r\n&lt;/font&gt;</span></p>\r\n<p><span style=\"font-size:x-small;color:#2b91af\"><span style=\"font-size:x-small;color:#2b91af\">DaysOfTheWeek</span></span><span style=\"font-size:x-small\">.Monday;&lt;font size=&quot;2&quot;&gt;\r\n<p>trigger.StartBoundary =</p>\r\n&lt;/font&gt;</span></p>\r\n<p><span style=\"font-size:x-small;color:#2b91af\"><span style=\"font-size:x-small;color:#2b91af\">DateTime</span></span><span style=\"font-size:x-small\">.Now;\r\n<p>trigger.WeeksInterval = 1;</p>\r\n<p>gr1Task.Definition.Triggers.Add(trigger);</p>\r\n<p>}</p>\r\n<p>This code don't work.</p>\r\n<div id=\"result_box\" style=\"text-align:left\" dir=ltr>Trigger not added to the task. <br>Why?</div>\r\n</span></p>\r\n</div>",
    "PostedDate": "2009-05-12T05:34:50.193-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "190821",
    "ThreadId": "56041",
    "Html": "<p><span style=\"font-size:10pt;color:black;font-family:'Segoe UI','sans-serif'\">You must grab the TaskDefinition first and then register that definition&nbsp;after adding the trigger. It should be easier and more intuitive, but this mimics the model used when coding directly with the COM interfaces. Use this code, and it should work:</span></p>\r\n<p><span style=\"font-size:10pt;color:black;font-family:'Segoe UI','sans-serif'\">\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">using</span> (TaskService toTaskService = <span style=\"color:Blue\">new</span> TaskService())\r\n{\r\n      Task gr1Task = toTaskService.GetTask(<span style=\"color:#A31515\">&quot;GR1&quot;</span>);\r\n\r\n      <span style=\"color:Green\">// Grab an instance of the definition</span>\r\n      TaskDefinition td = gr1Task.Definition;\r\n\r\n      <span style=\"color:Green\">// Add the new trigger to the definition</span>\r\n      td.Triggers.Add(<span style=\"color:Blue\">new</span> WeeklyTrigger() { DaysOfWeek = DaysOfTheWeek.Monday, StartBoundary = DateTime.Now, WeeksInterval = 1 });\r\n\r\n      <span style=\"color:Green\">// Register the definition</span>\r\n      toTaskService.RootFolder.RegisterTaskDefinition(gr1Task.Path, td, TaskCreation.Update, <span style=\"color:Blue\">null</span>, <span style=\"color:Blue\">null</span>, td.Principal.LogonType, <span style=\"color:Blue\">null</span>);\r\n}</pre>\r\n</div>\r\n</span></p>",
    "PostedDate": "2009-05-15T10:38:07.083-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]