[
  {
    "Id": "1308947",
    "ThreadId": "568593",
    "Html": "Hi <br />\nI would like to enquire about  creating task scheduler  with asp.net<br />\nPlease kindly recommend me how to create task scheduler  within web application with asp. net(C#).<br />\nI try testing by the following codes in console application. It is great.<br />\n<pre><code>using Microsoft.Win32.TaskScheduler;\nstatic void Main(string[] args)\n        {\n            using (TaskService ts = new TaskService())\n            {\n                TaskDefinition td = ts.NewTask();\n                td.RegistrationInfo.Description = &quot;My first PurgeApplication task scheduler&quot;;\n\n                DateTime start = DateTime.Now.AddMinutes(1);\n                td.Triggers.Add(new TimeTrigger() { StartBoundary = start });\n\n                string path = @&quot;C:/inetpub/wwwroot/AppManageWindowScheduler/exe/PurgeApplication.exe&quot;;\n\n                td.Actions.Add(new ExecAction(path, null, null));\n                ts.RootFolder.RegisterTaskDefinition(&quot;My first parallell task scheduler&quot;, td);\n            }\n        }</code></pre>\n\nHowever, I try testing in web app instead. It occur error.<br />\n<a href=\"http://localhost/AppManageWindowScheduler/Default.aspx\" rel=\"nofollow\">http://localhost/AppManageWindowScheduler/Default.aspx</a><br />\n<pre><code>using Microsoft.Win32.TaskScheduler;\nprotected void Page_Load(object sender, EventArgs e)\n    {\n        CreateTaskRunOnce();\n    }\n    private void CreateTaskRunOnce()\n    {\n        using (TaskService ts = new TaskService())\n        {\n            TaskDefinition td = ts.NewTask();\n            td.RegistrationInfo.Description = &quot;My first PurgeApplication task scheduler&quot;;\n\n            DateTime start = DateTime.Now.AddMinutes(1);\n            td.Triggers.Add(new TimeTrigger() { StartBoundary = start });\n\n           // string path = @&quot;C:/inetpub/wwwroot/AppManageWindowScheduler/exe/PurgeApplication.exe&quot;;\n            string path = Server.MapPath(&quot;~/exe/PurgeApplication.exe&quot;);\n\n            td.Actions.Add(new ExecAction(path, null, null));\n            ts.RootFolder.RegisterTaskDefinition(&quot;My first parallell task scheduler&quot;, td);\n        }\n    }\n</code></pre>\n\nI suspect that error may occur from “string path = Server.MapPath(&quot;~/exe/PurgeApplication.exe&quot;);” . <br />\n<br />\nCould you please suggest me to what is good solution for resolving this?<br />\nI  indeed need to create task scheduler through  asp.net web site.<br />\nFor given error , please see below.<br />\n(38,4):Task: <br />\nDescription: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. <br />\n<br />\nException Details: System.Runtime.InteropServices.COMException: (38,4):Task:<br />\n<br />\nSource Error: <br />\n<br />\nLine 30: <br />\nLine 31:             td.Actions.Add(new ExecAction(path, null, null));<br />\nLine 32:             ts.RootFolder.RegisterTaskDefinition(&quot;My first parallell task scheduler&quot;, td);<br />\nLine 33:         }<br />\nLine 34:     }<br />\n<br />\nSource File: c:\\inetpub\\wwwroot\\AppManageWindowScheduler\\Default.aspx.cs    Line: 32 <br />\n<br />\nStack Trace: <br />\n<br />\n[COMException (0x80041318): (38,4):Task:]<br />\n   Microsoft.Win32.TaskScheduler.V2Interop.ITaskFolder.RegisterTaskDefinition(String Path, ITaskDefinition pDefinition, Int32 flags, Object UserId, Object password, TaskLogonType LogonType, Object sddl) +0<br />\n   Microsoft.Win32.TaskScheduler.TaskFolder.RegisterTaskDefinition(String Path, TaskDefinition definition, TaskCreation createType, String UserId, String password, TaskLogonType LogonType, String sddl) +237<br />\n   Microsoft.Win32.TaskScheduler.TaskFolder.RegisterTaskDefinition(String Path, TaskDefinition definition) +284<br />\n   _Default.CreateTaskRunOnce() in c:\\inetpub\\wwwroot\\AppManageWindowScheduler\\Default.aspx.cs:32<br />\n   _Default.Page_Load(Object sender, EventArgs e) in c:\\inetpub\\wwwroot\\AppManageWindowScheduler\\Default.aspx.cs:16<br />\n   System.Web.UI.Control.LoadRecursive() +71<br />\n   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +3178<br />\n",
    "PostedDate": "2014-09-29T08:48:58.463-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1309543",
    "ThreadId": "568593",
    "Html": "There are some security and configuration issues that need to be addressed when calling from within ASP.NET. Please look at the documentation under &quot;Connecting to a server&quot; and then through the &quot;Discussions&quot; for ASP.NET specific notes. There have been many so you should be able to find your answer. Please let me know if you can't.<br />\n",
    "PostedDate": "2014-10-01T05:24:37.063-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]