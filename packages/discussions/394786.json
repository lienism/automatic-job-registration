[
  {
    "Id": "909702",
    "ThreadId": "394786",
    "Html": "\r\n<p>Trying to schedule a task in Global.asax on a 2008 R2 machine. &nbsp;The task scheduling works fine locally (Win 7), but remotely I get:</p>\r\n<p>[COMException (0x80041318): (42,4):Task:]</p>\r\n<p>System.Runtime.InteropServices.COMException: (42,4):Task:</p>\r\n<p>It seems like this is an error in the XML, but when I import the XML manually in to the Task Scheduler UI it works fine.</p>\r\n<p>Here is the XML:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;?</span><span style=\"color:#a31515\">xml</span> <span style=\"color:red\">version</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">1.0</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">encoding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">UTF-16</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">?&gt;</span>\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Task</span> <span style=\"color:red\">version</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">1.2</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/windows/2004/02/mit/task</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">RegistrationInfo</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Author</span><span style=\"color:blue\">&gt;</span>Project.Name<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Author</span><span style=\"color:blue\">&gt;</span>\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">RegistrationInfo</span><span style=\"color:blue\">&gt;</span>\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Triggers</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">CalendarTrigger</span><span style=\"color:blue\">&gt;</span>\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">StartBoundary</span><span style=\"color:blue\">&gt;</span>2012-09-07T16:52:47.912<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">StartBoundary</span><span style=\"color:blue\">&gt;</span>\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Enabled</span><span style=\"color:blue\">&gt;</span>true<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Enabled</span><span style=\"color:blue\">&gt;</span>\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">ScheduleByDay</span><span style=\"color:blue\">&gt;</span>\n        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">DaysInterval</span><span style=\"color:blue\">&gt;</span>1<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">DaysInterval</span><span style=\"color:blue\">&gt;</span>\n      <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">ScheduleByDay</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">CalendarTrigger</span><span style=\"color:blue\">&gt;</span>\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Triggers</span><span style=\"color:blue\">&gt;</span>\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Settings</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">MultipleInstancesPolicy</span><span style=\"color:blue\">&gt;</span>IgnoreNew<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">MultipleInstancesPolicy</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">DisallowStartIfOnBatteries</span><span style=\"color:blue\">&gt;</span>true<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">DisallowStartIfOnBatteries</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">StopIfGoingOnBatteries</span><span style=\"color:blue\">&gt;</span>true<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">StopIfGoingOnBatteries</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">AllowHardTerminate</span><span style=\"color:blue\">&gt;</span>true<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">AllowHardTerminate</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">StartWhenAvailable</span><span style=\"color:blue\">&gt;</span>false<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">StartWhenAvailable</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">RunOnlyIfNetworkAvailable</span><span style=\"color:blue\">&gt;</span>false<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">RunOnlyIfNetworkAvailable</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">IdleSettings</span><span style=\"color:blue\">&gt;</span>\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Duration</span><span style=\"color:blue\">&gt;</span>PT10M<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Duration</span><span style=\"color:blue\">&gt;</span>\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">WaitTimeout</span><span style=\"color:blue\">&gt;</span>PT1H<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">WaitTimeout</span><span style=\"color:blue\">&gt;</span>\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">StopOnIdleEnd</span><span style=\"color:blue\">&gt;</span>true<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">StopOnIdleEnd</span><span style=\"color:blue\">&gt;</span>\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">RestartOnIdle</span><span style=\"color:blue\">&gt;</span>false<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">RestartOnIdle</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">IdleSettings</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">AllowStartOnDemand</span><span style=\"color:blue\">&gt;</span>true<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">AllowStartOnDemand</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Enabled</span><span style=\"color:blue\">&gt;</span>true<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Enabled</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Hidden</span><span style=\"color:blue\">&gt;</span>false<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Hidden</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">RunOnlyIfIdle</span><span style=\"color:blue\">&gt;</span>false<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">RunOnlyIfIdle</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">WakeToRun</span><span style=\"color:blue\">&gt;</span>false<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">WakeToRun</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">ExecutionTimeLimit</span><span style=\"color:blue\">&gt;</span>PT72H<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">ExecutionTimeLimit</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Priority</span><span style=\"color:blue\">&gt;</span>7<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Priority</span><span style=\"color:blue\">&gt;</span>\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Settings</span><span style=\"color:blue\">&gt;</span>\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Actions</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Exec</span><span style=\"color:blue\">&gt;</span>\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Command</span><span style=\"color:blue\">&gt;</span>C:\\inetpub\\wwwroot\\bin\\myjob.EXE<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Command</span><span style=\"color:blue\">&gt;</span>\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Arguments</span><span style=\"color:blue\">&gt;</span>--job=JobName --params param1=&quot;value&quot;<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Arguments</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Exec</span><span style=\"color:blue\">&gt;</span>\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Actions</span><span style=\"color:blue\">&gt;</span>\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Task</span><span style=\"color:blue\">&gt;</span>\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>Any thoughts?</p>\r\n",
    "PostedDate": "2012-09-07T09:57:22.977-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "909764",
    "ThreadId": "394786",
    "Html": "<p>Try removing the '.' from the Author tag. I have seen periods screw things up before.</p>",
    "PostedDate": "2012-09-07T12:30:42.583-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "909776",
    "ThreadId": "394786",
    "Html": "\r\n<p>Thanks for the quick response but no luck, just gave that a shot without periods in the Author and still not working.</p>\r\n",
    "PostedDate": "2012-09-07T12:58:00.657-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "909817",
    "ThreadId": "394786",
    "Html": "\r\n<p>I made some progress when I added a principal block. &nbsp;I added that block because I tried doing this manually on the machine and exporting and that was the only main difference.</p>\r\n<p>The scheduling is happening in a process running as IIS AppPool\\DefaultAppPool right now so not having much luck. &nbsp;Is the only way to get that to work to change the app pool identity? &nbsp;Main reason I ask is that this is on an Amazon ElasticBeanstalk\r\n machine, so I don't really have the ability to do that unless I start using custom images and I'm trying to avoid that.</p>\r\n",
    "PostedDate": "2012-09-07T15:02:54.503-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "910200",
    "ThreadId": "394786",
    "Html": "\r\n<p>You can eliminate the Principal block and then use the parameters on the RegisterTaskDefinition method to set those values. The process must have appropriate permissions to connect to the TaskService. There are a number of articles on MSDN that detail what\r\n permissions are needed within the host process, when credentials should be provided when connecting to a TaskService instance, and what needs to be done within RegisterTaskDefinition.</p>\r\n",
    "PostedDate": "2012-09-09T11:20:50.83-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": "2014-04-03T11:39:06.503-07:00"
  }
]