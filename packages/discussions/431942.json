[
  {
    "Id": "996357",
    "ThreadId": "431942",
    "Html": "Hi, <br />\nTaskScheduler v1.9.2.28583<br />\nTaskSchedulerEditor v1.9.2.28588<br />\nAeroWizard v1.2.3.22616<br />\n<br />\nwhen using the code below, the TaskSchedulerWizard crashes when clicking on the radio buttons (&quot;Run...&quot; etc.) in the wizard step &quot;Security Options&quot;. (see stack trace below).<br />\nIt also crashes with an &quot;Object reference not set to an instance of an object&quot; exception (see 2nd stack trace) after selecting a user account in the same step. <br />\nWhat am I missing?<br />\n<pre><code>      string FolderName = &quot;My Folder&quot;;\n      using (var taskService = new TaskService())\n      {\n        bool v2 = taskService.HighestSupportedVersion &gt; new Version(1, 1);\n\n        var taskFolder = taskService.RootFolder;\n        if (taskService.HighestSupportedVersion &gt; new Version(1, 0, 0, 0))\n        {\n          try\n          {\n            taskService.GetFolder(FolderName);\n          }\n          catch (FileNotFoundException fex)\n          {\n            taskFolder.CreateFolder(FolderName);\n          }\n\n          taskFolder = taskService.GetFolder(FolderName);\n        }\n\n        using (var taskSchedulerWizard = new TaskSchedulerWizard())\n        {\n          var newTaskDefinition = taskService.NewTask();\n          newTaskDefinition.Actions.Add(new ExecAction(&quot;notepad.exe&quot;));\n\n          taskSchedulerWizard.Initialize(taskService, newTaskDefinition);\n          taskSchedulerWizard.RegisterTaskOnFinish = !v2;\n\n          taskSchedulerWizard.AvailablePages = TaskSchedulerWizard.AvailableWizardPages.IntroPage |\n            TaskSchedulerWizard.AvailableWizardPages.SecurityPage |\n            TaskSchedulerWizard.AvailableWizardPages.SummaryPage |\n            TaskSchedulerWizard.AvailableWizardPages.TriggerPropertiesPage |\n            TaskSchedulerWizard.AvailableWizardPages.TriggerSelectPage;\n\n          if (taskSchedulerWizard.ShowDialog() != DialogResult.OK) return;\n          if (v2)\n          {\n            taskFolder.RegisterTaskDefinition(taskSchedulerWizard.TaskName, taskSchedulerWizard.TaskDefinition);\n          }\n          //    _tlv.Tasks = taskFolder.Tasks;\n        }\n      }\n</code></pre>\n\nSystem.NullReferenceException was unhandled<br />\n  HResult=-2147467261<br />\n  Message=Object reference not set to an instance of an object.<br />\n  Source=Microsoft.Win32.TaskSchedulerEditor<br />\n  StackTrace:<br />\n<pre><code>   at Microsoft.Win32.TaskScheduler.TaskSchedulerWizard.taskLoggedOnRadio_CheckedChanged(Object sender, EventArgs e)\n   at System.Windows.Forms.RadioButton.OnClick(EventArgs e)\n   at System.Windows.Forms.RadioButton.OnMouseUp(MouseEventArgs mevent)\n   at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n   at System.Windows.Forms.Control.WndProc(Message&amp; m)\n   at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)\n   at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n   at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG&amp; msg)\n   at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData)\n   at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)\n   at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)\n   at System.Windows.Forms.Form.ShowDialog(IWin32Window owner)\n   at BassicTech.TestHarness.Form1.btnScheduler_Click(Object sender, EventArgs e) in c:\\Projects3\\Tester\\Form1.cs:line 533\n   at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\n   at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n   at System.Windows.Forms.Control.WndProc(Message&amp; m)\n   at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)\n   at System.Windows.Forms.Button.WndProc(Message&amp; m)\n   at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n   at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG&amp; msg)\n   at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData)\n   at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)\n   at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)\n   at BassicTech.TestHarness.Program.Main() in c:\\Projects3\\Tester\\Program.cs:line 17\n   at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)\n   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)\n   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)\n   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n   at System.Threading.ThreadHelper.ThreadStart()</code></pre>\n\nInnerException: <br />\n<br />\n<strong>----------- 2nd: stack trace  --------------</strong><br />\nSee the end of this message for details on invoking <br />\njust-in-time (JIT) debugging instead of this dialog box.<br />\n<br />\n************** Exception Text **************<br />\nSystem.NullReferenceException: Object reference not set to an instance of an object.<br />\n   at Microsoft.Win32.TaskScheduler.TaskSchedulerWizard.changePrincipalButton_Click(Object sender, EventArgs e)<br />\n   at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)<br />\n   at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)<br />\n   at System.Windows.Forms.Control.WndProc(Message&amp; m)<br />\n   at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)<br />\n   at System.Windows.Forms.Button.WndProc(Message&amp; m)<br />\n   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)<br />\n<br />\n<br />\n************** Loaded Assemblies **************<br />\nmscorlib<br />\n<pre><code>Assembly Version: 4.0.0.0\nWin32 Version: 4.0.30319.18033 built by: FX45RTMGDR</code></pre>\n\n<h2>    CodeBase: file:///C:/Windows/Microsoft.NET/Framework64/v4.0.30319/mscorlib.dll</h2>\nTestHarness<br />\n<pre><code>Assembly Version: 1.0.0.0\nWin32 Version: 1.0.0.0</code></pre>\n\n<h2>    CodeBase: file:///C:/Projects3/Tester/bin/x86/Debug/TestHarness.exe</h2>\nSystem.Windows.Forms<br />\n<pre><code>Assembly Version: 4.0.0.0\nWin32 Version: 4.0.30319.18033 built by: FX45RTMGDR</code></pre>\n\n<h2>    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Windows.Forms/v4.0_4.0.0.0__b77a5c561934e089/System.Windows.Forms.dll</h2>\nSystem.Drawing<br />\n<pre><code>Assembly Version: 4.0.0.0\nWin32 Version: 4.0.30319.18022 built by: FX45RTMGDR</code></pre>\n\n<h2>    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Drawing/v4.0_4.0.0.0__b03f5f7f11d50a3a/System.Drawing.dll</h2>\nSystem<br />\n<pre><code>Assembly Version: 4.0.0.0\nWin32 Version: 4.0.30319.18033 built by: FX45RTMGDR</code></pre>\n\n<h2>    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System/v4.0_4.0.0.0__b77a5c561934e089/System.dll</h2>\nSystem.Configuration<br />\n<pre><code>Assembly Version: 4.0.0.0\nWin32 Version: 4.0.30319.17929 built by: FX45RTMREL</code></pre>\n\n<h2>    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Configuration/v4.0_4.0.0.0__b03f5f7f11d50a3a/System.Configuration.dll</h2>\nSystem.Xml<br />\n<pre><code>Assembly Version: 4.0.0.0\nWin32 Version: 4.0.30319.18033 built by: FX45RTMGDR</code></pre>\n\n<h2>    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Xml/v4.0_4.0.0.0__b77a5c561934e089/System.Xml.dll</h2>\nMicrosoft.Win32.TaskScheduler<br />\n<pre><code>Assembly Version: 1.9.2.28583\nWin32 Version: 1.9.2.0</code></pre>\n\n<h2>    CodeBase: file:///C:/Projects3/Tester/bin/x86/Debug/Microsoft.Win32.TaskScheduler.DLL</h2>\nMicrosoft.Win32.TaskSchedulerEditor<br />\n<pre><code>Assembly Version: 1.9.2.28588\nWin32 Version: 1.9.2.0</code></pre>\n\n<h2>    CodeBase: file:///C:/Projects3/Tester/bin/x86/Debug/Microsoft.Win32.TaskSchedulerEditor.DLL</h2>\nTimeSpan2<br />\n<pre><code>Assembly Version: 2.0.2.14660\nWin32 Version: 2.0.2.0</code></pre>\n\n<h2>    CodeBase: file:///C:/Projects3/Tester/bin/x86/Debug/TimeSpan2.DLL</h2>\nAeroWizard<br />\n<pre><code>Assembly Version: 1.2.3.22616\nWin32 Version: 1.2.3.0</code></pre>\n\n<h2>    CodeBase: file:///C:/Projects3/Tester/bin/x86/Debug/AeroWizard.DLL</h2>\nGroupControls<br />\n<pre><code>Assembly Version: 1.3.6.22332\nWin32 Version: 1.3.6.0</code></pre>\n\n<h2>    CodeBase: file:///C:/Projects3/Tester/bin/x86/Debug/GroupControls.DLL</h2>\nSystem.Core<br />\n<pre><code>Assembly Version: 4.0.0.0\nWin32 Version: 4.0.30319.17929 built by: FX45RTMREL</code></pre>\n\n<h2>    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Core/v4.0_4.0.0.0__b77a5c561934e089/System.Core.dll</h2>\nCubicOrange.Windows.Forms.ActiveDirectory<br />\n<pre><code>Assembly Version: 2.2.4395.25898\nWin32 Version: 2.2.0.0</code></pre>\n\n<h2>    CodeBase: file:///C:/Projects3/Tester/bin/x86/Debug/CubicOrange.Windows.Forms.ActiveDirectory.DLL</h2>\n************** JIT Debugging **************<br />\nTo enable just-in-time (JIT) debugging, the .config file for this<br />\napplication or computer (machine.config) must have the<br />\njitDebugging value set in the system.windows.forms section.<br />\nThe application must also be compiled with debugging<br />\nenabled.<br />\n<br />\nFor example:<br />\n<br />\n&lt;configuration&gt;<br />\n<pre><code>&lt;system.windows.forms jitDebugging=&quot;true&quot; /&gt;</code></pre>\n\n&lt;/configuration&gt;<br />\n<br />\nWhen JIT debugging is enabled, any unhandled exception<br />\nwill be sent to the JIT debugger registered on the computer<br />\nrather than be handled by this dialog box.<br />\n",
    "PostedDate": "2013-02-04T13:45:30.787-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "996405",
    "ThreadId": "431942",
    "Html": "I think you have run across a bug that I have fixed for the next release (1.9.3). I should be posting it in the next few days. Also, I thought I'd make you aware of the TaskFolder property on the wizard. Using it, your code would look like:<br />\n<pre><code>string FolderName = &quot;My Folder&quot;;\nusing (var ts = new TaskService())\n{\n   var taskFolder = ts.RootFolder;\n   if (ts.HighestSupportedVersion &gt; new Version(1, 1))\n   {\n      try\n      {\n         taskFolder = ts.GetFolder(FolderName);\n      }\n      catch (System.IO.FileNotFoundException)\n      {\n         taskFolder = ts.RootFolder.CreateFolder(FolderName);\n      }\n   }\n\n   using (var taskSchedulerWizard = new TaskSchedulerWizard())\n   {\n      var newTaskDefinition = ts.NewTask();\n      newTaskDefinition.Actions.Add(new ExecAction(&quot;notepad.exe&quot;));\n      taskSchedulerWizard.Initialize(ts, newTaskDefinition);\n      taskSchedulerWizard.TaskFolder = FolderName;\n      taskSchedulerWizard.RegisterTaskOnFinish = true;\n      taskSchedulerWizard.AvailablePages = TaskSchedulerWizard.AvailableWizardPages.IntroPage |\n         TaskSchedulerWizard.AvailableWizardPages.SecurityPage |\n         TaskSchedulerWizard.AvailableWizardPages.SummaryPage |\n         TaskSchedulerWizard.AvailableWizardPages.TriggerPropertiesPage |\n         TaskSchedulerWizard.AvailableWizardPages.TriggerSelectPage;\n\n      if (taskSchedulerWizard.ShowDialog() != DialogResult.OK) return;\n   }\n}</code></pre>\n\n",
    "PostedDate": "2013-02-04T15:32:55.587-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "996862",
    "ThreadId": "431942",
    "Html": "Thanks, looking forward to the next release.\r<br />\n/M<br />\n",
    "PostedDate": "2013-02-05T11:30:36.057-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]