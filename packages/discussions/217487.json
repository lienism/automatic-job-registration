[
  {
    "Id": "460383",
    "ThreadId": "217487",
    "Html": "<p>Using VS2010 in XP. Created example code:</p>\r\n<p>Snippet</p>\r\n<pre style=\"font-family:consolas\">\t\t\t<span style=\"color:blue\">using</span>&nbsp;(<span style=\"color:#2b91af\">TaskService</span>&nbsp;ts&nbsp;=&nbsp;<span style=\"color:blue\">new</span>&nbsp;<span style=\"color:#2b91af\">TaskService</span>())<br>\t\t\t{<br> <br> <br>\t\t\t\t<span style=\"color:blue\">const</span>&nbsp;<span style=\"color:blue\">string</span>&nbsp;taskName&nbsp;=&nbsp;<span style=\"color:#a31515\">&quot;Test&quot;</span>;<br>\t\t\t\t<span style=\"color:#2b91af\">Task</span>&nbsp;t&nbsp;=&nbsp;ts.AddTask(taskName,<br>\t\t\t\t&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">new</span>&nbsp;<span style=\"color:#2b91af\">TimeTrigger</span>()&nbsp;{&nbsp;StartBoundary&nbsp;=&nbsp;<span style=\"color:#2b91af\">DateTime</span>.Now&nbsp;+&nbsp;<span style=\"color:#2b91af\">TimeSpan</span>.FromHours(1),&nbsp;Enabled&nbsp;=&nbsp;<span style=\"color:blue\">false</span>&nbsp;},<br>\t\t\t\t&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">new</span>&nbsp;<span style=\"color:#2b91af\">ExecAction</span>(<span style=\"color:#a31515\">&quot;notepad.exe&quot;</span>,&nbsp;<span style=\"color:#a31515\">&quot;c:\\\\test.log&quot;</span>,&nbsp;<span style=\"color:#a31515\">&quot;C:\\\\&quot;</span>));<br> <br>\t\t\t\t<span style=\"color:green\">//&nbsp;Edit&nbsp;task&nbsp;and&nbsp;re-register&nbsp;if&nbsp;user&nbsp;clicks&nbsp;Ok</span><br>\t\t\t\t<span style=\"color:#2b91af\">TaskEditDialog</span>&nbsp;editorForm&nbsp;=&nbsp;<span style=\"color:blue\">new</span>&nbsp;<span style=\"color:#2b91af\">TaskEditDialog</span>();<br>\t\t\t\teditorForm.Editable&nbsp;=&nbsp;<span style=\"color:blue\">true</span>;<br>\t\t\t\teditorForm.Initialize(t);<br>\t\t\t\t<span style=\"color:blue\">if</span>&nbsp;(editorForm.ShowDialog()&nbsp;==&nbsp;System.Windows.Forms.<span style=\"color:#2b91af\">DialogResult</span>.OK)<br>\t\t\t\t{<br>\t\t\t\t\tts.RootFolder.RegisterTaskDefinition(taskName,&nbsp;editorForm.TaskDefinition);<br>\t\t\t\t}<br> <br>\t\t\t\t<span style=\"color:green\">//&nbsp;Remove&nbsp;the&nbsp;task&nbsp;we&nbsp;just&nbsp;created</span><br>\t\t\t\tts.RootFolder.DeleteTask(taskName);<br> <br>\t\t\t}<br><br>Executing editorForm.Initialize(t) throws the following exception:<br><br>System.NullReferenceException was unhandled<br>&nbsp; Message=Object reference not set to an instance of an object.<br>&nbsp; Source=Microsoft.Win32.TaskScheduler<br>&nbsp; StackTrace:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Win32.TaskScheduler.TaskService.ShouldSerializeUserName()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Win32.TaskScheduler.TaskService.get_UserName()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Win32.TaskScheduler.TaskPropertiesControl.set_TaskDefinition(TaskDefinition value)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Win32.TaskScheduler.TaskPropertiesControl.set_Task(Task value)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Win32.TaskScheduler.TaskPropertiesControl.Initialize(Task task)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Win32.TaskScheduler.TaskEditDialog.Initialize(Task task)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at TIRATool.MainForm.ScheduleButton_Click(Object sender, EventArgs e) in F:\\SoftSys\\Projects\\TIRA TV Control\\TIRATool\\TIRATool\\MainForm.cs:line 264<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnClick(EventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Button.OnClick(EventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.WndProc(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Button.WndProc(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG&amp; msg)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(Int32 dwComponentID, Int32 reason, Int32 pvLoopData)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.Run(Form mainForm)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at TIRATool.Program.Main(String[] args) in F:\\SoftSys\\Projects\\TIRA TV Control\\TIRATool\\TIRATool\\Program.cs:line 25<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain.nExecuteAssembly(Assembly assembly, String[] args)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Runtime.Hosting.ManifestRunner.Run(Boolean checkAptModel)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Runtime.Hosting.ManifestRunner.ExecuteAsAssembly()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Runtime.Hosting.ApplicationActivator.CreateInstance(ActivationContext activationContext, String[] activationCustomData)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Runtime.Hosting.ApplicationActivator.CreateInstance(ActivationContext activationContext)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Activator.CreateInstance(ActivationContext activationContext)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssemblyDebugInZone()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart_Context(Object state)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart()<br>&nbsp; InnerException: <br><br><br></pre>",
    "PostedDate": "2010-06-27T11:09:57.337-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "462406",
    "ThreadId": "217487",
    "Html": "<p>Try this:</p>\r\n<p>When instantiating a new taskService, I had to pass in the  constructor: username, accountDomain, password and forceV1 = true</p>\r\n<p>&nbsp;</p>\r\n<p>worked for me ;)</p>",
    "PostedDate": "2010-07-01T16:14:03.337-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "463245",
    "ThreadId": "217487",
    "Html": "<p>There was actually a bug in the Beta 2 release that caused this failure. Try the 1.5 Beta 3 code and remove the changes you made to the TaskService constructor.</p>",
    "PostedDate": "2010-07-04T08:27:52.907-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]