[
  {
    "Id": "465051",
    "ThreadId": "218822",
    "Html": "<p>Good Day:</p>\r\n<p>I've been trying to figure out a way of being able to bring back data on Scheduled Tasks.</p>\r\n<p>Basically I want to get the collection of Tasks, Loop thru them and display data from that.</p>\r\n<p>I've tried the following but I can't get it to work.</p>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">\r\n<p>Microsoft.Win32.TaskScheduler.</p>\r\n</span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">TaskCollection</span></span><span style=\"font-size:x-small\"> taskNames = </span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">default</span></span><span style=\"font-size:x-small\">(Microsoft.Win32.TaskScheduler.</span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">TaskCollection</span></span><span style=\"font-size:x-small\">);</span></span><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">\r\n<p>&nbsp;</p>\r\n</span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">string</span></span><span style=\"font-size:x-small\"> sTaskList = </span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;&lt;table&gt;&quot;</span></span><span style=\"font-size:x-small\">;</span></span><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"> </span></span><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">&lt;font size=&quot;2&quot;&gt;\r\n<p>&nbsp;</p>\r\n&lt;/font&gt;<span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">foreach</span></span><span style=\"font-size:x-small\"> (Microsoft.Win32.TaskScheduler.</span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">Task</span></span><span style=\"font-size:x-small\"> t </span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">in</span></span><span style=\"font-size:x-small\"> taskNames)</span></span><span style=\"font-size:x-small\"> </span></span></span><span style=\"font-size:x-small\">\r\n<p>\r\n<p>{</p>\r\n<span style=\"font-size:x-small\">&nbsp;</span></p>\r\n</span>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">&lt;font size=&quot;2&quot;&gt;\r\n<p>&nbsp;</p>\r\n&lt;/font&gt;<span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">string</span></span><span style=\"font-size:x-small\"> sApplicationName = t.Name;</span></span></span></span></p>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">//The original version of this task scheduler had a way to get the Creator, but I don't see that with this version.</span></span></p>\r\n<p><span style=\"font-size:x-small\">//&nbsp;<span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">string</span></span><span style=\"font-size:x-small\"> sCreator = &quot;&quot;; //</span><span style=\"color:#008000;font-size:x-small\"><span style=\"color:#008000;font-size:x-small\">t.Creator;</span></span></span><span style=\"color:#008000;font-size:x-small\">&nbsp;</span><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"> <span style=\"font-size:x-small\">&lt;font size=&quot;2&quot;&gt;\r\n<p>&nbsp;</p>\r\n&lt;/font&gt;<span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">string</span></span><span style=\"font-size:x-small\"> sNextRungTime = t.NextRunTime.ToString();</span></span><span style=\"font-size:x-small\">&lt;font size=&quot;2&quot;&gt; &lt;/font&gt;</span></span></span><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">&lt;font size=&quot;2&quot;&gt;\r\n<p>&nbsp;</p>\r\n&lt;/font&gt;</span><span style=\"font-size:x-small\">&lt;font size=&quot;2&quot;&gt;sTaskList = sTaskList +&lt;/font&gt;</span></span></span><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">&lt;font size=&quot;2&quot;&gt;\r\n<p>&nbsp;</p>\r\n&lt;/font&gt;<span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;&lt;tr&gt;&lt;td class='normaltablecell'&gt;&quot;</span></span><span style=\"font-size:x-small\"> + sApplicationName + </span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;&lt;/td&gt;&lt;td class='normaltablecell'&gt;&quot;</span></span><span style=\"font-size:x-small\"> + sCreator + </span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;&lt;/td&gt;&lt;td class='normaltablecell'&gt;&quot;</span></span><span style=\"font-size:x-small\"> + sNextRungTime + </span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span></span><span style=\"font-size:x-small\">;</span></span><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"> </span></span></span></span><span style=\"font-size:x-small\">\r\n<p>}</p>\r\n<p><span style=\"font-size:x-small\">&lt;font size=&quot;2&quot;&gt;\r\n<p>sTaskList = sTaskList +</p>\r\n&lt;/font&gt;</span></p>\r\n<p>&nbsp;</p>\r\n<p><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;&lt;/table&gt;&quot;</span></span><span style=\"font-size:x-small\">;</span></p>\r\n<p>&nbsp;</p>\r\n<p>I try and use this code and it doesn't work.</p>\r\n<p>Any ideas on the best way to be able to bring this data back using this Wrapper?</p>\r\n<p>Thanks for your help.</p>\r\n<p>Mary</p>\r\n</span></p>\r\n</p>",
    "PostedDate": "2010-07-08T13:11:02.767-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "466501",
    "ThreadId": "218822",
    "Html": "<p>There are a few considerations:</p>\r\n<ol>\r\n<li>Which OS will the applications be running under? If Vista/Svr03 or later, then tasks are in&nbsp;a hierarchal structure. Prior to that, there is a single folder.</li>\r\n<li>Do you want running tasks or all tasks?</li>\r\n<li>The data for each task is found either at the Task object level (for more run-time info) or under the TaskDefinition's properties.</li>\r\n<li>What information do you want about the actions? Not all tasks trigger an application. Some can trigger messages, emails, and COM execution.</li>\r\n</ol>\r\n<p>A list of all tasks in the root folder along with basic information can be retrieved using the following code:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>TaskService ts = <span style=\"color:blue\">new</span> TaskService();\r\n<span style=\"color:blue\">foreach</span> (Task t <span style=\"color:blue\">in</span> ts.RootFolder.Tasks)\r\n{\r\n   <span style=\"color:blue\">try</span>\r\n   {\r\n      Console.WriteLine(<span style=\"color:#a31515\">&quot;+ {0}, {1} ({2})&quot;</span>, t.Name, t.Definition.RegistrationInfo.Author, t.NextRunTime);\r\n      <span style=\"color:blue\">foreach</span> (Trigger trg <span style=\"color:blue\">in</span> t.Definition.Triggers)\r\n         Console.WriteLine(<span style=\"color:#a31515\">&quot; + {0}&quot;</span>, trg);\r\n      <span style=\"color:blue\">foreach</span> (<span style=\"color:blue\">var</span> act <span style=\"color:blue\">in</span> t.Definition.Actions)\r\n         Console.WriteLine(<span style=\"color:#a31515\">&quot; = {0}&quot;</span>, act);\r\n   }\r\n   <span style=\"color:blue\">catch</span> { }\r\n}\r\n</pre>\r\n</div>",
    "PostedDate": "2010-07-12T13:47:53.287-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]