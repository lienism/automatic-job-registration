[
  {
    "Id": "730406",
    "ThreadId": "287336",
    "Html": "<p>I have some problems creating a daily trigger with repetition.</p>\n<p>my code is copied from the example page and looks like following:</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: green;\">// Create a new task definition and assign properties</span>\nTaskDefinition td = ts.NewTask();\ntd.Principal.LogonType = TaskLogonType.InteractiveToken;\n\n<span style=\"color: blue;\">var</span> trigger = <span style=\"color: blue;\">new</span> DailyTrigger();\ntrigger.Repetition.Interval = TimeSpan.FromHours(2);\ntrigger.StartBoundary = DateTime.Now.AddMinutes(2);\n\n<span style=\"color: green;\">// Create a trigger that will fire the task at this time every other day</span>\ntd.Triggers.Add(trigger);\n\n<span style=\"color: green;\">// Create an action that will launch Notepad whenever the trigger fires</span>\ntd.Actions.Add(<span style=\"color: blue;\">new</span> ExecAction(<span style=\"color: #a31515;\">\"notepad.exe\"</span>, fileName));\n\n<span style=\"color: green;\">// Register the task in the root folder</span>\nts.RootFolder.RegisterTaskDefinition(taskName, td);</pre>\n</div>\n<p>Under win 7 works like a charm, but under win xp throws an exception&nbsp;</p>\n<pre>Value does not fall within the expected range.<br /></pre>\n<pre>at Microsoft.Win32.TaskScheduler.V1Interop.ITaskTrigger.SetTrigger(TaskTrigger&amp; Trigger)   \nat Microsoft.Win32.TaskScheduler.Trigger.SetV1TriggerData() in C:\\Code\\TaskService\\Trigger.cs:line 606   \nat Microsoft.Win32.TaskScheduler.Trigger.Bind(ITask iTask) in C:\\Code\\TaskService\\Trigger.cs:line 556   \nat Microsoft.Win32.TaskScheduler.TriggerCollection.Add(Trigger unboundTrigger) in C:\\Code\\TaskService\\TriggerCollection.cs:line 174</pre>\n<p>Since i have found the following topic&nbsp;<span><a title=\"Problem between Version 1 and Version 2\" href=\"http://taskscheduler.codeplex.com/discussions/254053\" target=\"_blank\">Problem between Version 1 and Version 2</a>, i changed the code to the following:</span></p>\n<p><span>&nbsp;</span></p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: green;\">// Create a new task definition and assign properties</span>\nTaskDefinition td = ts.NewTask();\ntd.Principal.LogonType = TaskLogonType.InteractiveToken;\n\n<span style=\"color: blue;\">var</span> trigger = <span style=\"color: blue;\">new</span> DailyTrigger();\ntrigger.Repetition.Interval = TimeSpan.FromHours(2);\n<span style=\"color: green;\">// Changed for xp compatibility</span>\ntrigger.Repetition.Duration = TimeSpan.FromHours(3);\ntrigger.StartBoundary = DateTime.Now.AddMinutes(2);\n\n<span style=\"color: green;\">// Create a trigger that will fire the task at this time every other day</span>\ntd.Triggers.Add(trigger);\n\n<span style=\"color: green;\">// Create an action that will launch Notepad whenever the trigger fires</span>\ntd.Actions.Add(<span style=\"color: blue;\">new</span> ExecAction(<span style=\"color: #a31515;\">\"notepad.exe\"</span>, fileName));\n\n<span style=\"color: green;\">// Register the task in the root folder</span>\nts.RootFolder.RegisterTaskDefinition(taskName, td);</pre>\n</div>\n<p>Now it works as expected.</p>\n<p><span>as @daok wrote in <a title=\"Problem between Version 1 and Version 2\" href=\"http://taskscheduler.codeplex.com/discussions/254053\" target=\"_blank\"> Problem between Version 1 and Version 2</a>&nbsp;I think the API should handle those type of stuff for V1 and maybe trow a meaningful exception.</span></p>\n<p><span>Best regards Max</span></p>",
    "PostedDate": "2012-01-25T03:54:32.41-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "732785",
    "ThreadId": "287336",
    "Html": "<p>Thanks for posting your resolution.</p>",
    "PostedDate": "2012-01-30T11:23:02.35-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]