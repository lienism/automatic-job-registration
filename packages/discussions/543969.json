[
  {
    "Id": "1240242",
    "ThreadId": "543969",
    "Html": "<pre><code>var iRegTask = v2Folder.RegisterTaskDefinition(Path, definition.v2Def, (int)createType, UserId, password, LogonType, sddl);</code></pre>\n\nI have create a wix setup project and have included a defered custom action, that should install a windows task using the TSMW library.<br />\n<pre><code>   using (TaskService ts = new TaskService())\n            {\n                if (ts.FindTask(&quot;MyCustomTask&quot;, true) == null)\n                {\n                    // Create a new task definition and assign properties\n                    TaskDefinition td = ts.NewTask();\n                    td.RegistrationInfo.Description = &quot;MyCustomTask&quot;;\n\n                    td.Settings.DisallowStartIfOnBatteries = false;\n                    td.Settings.MultipleInstances = TaskInstancesPolicy.IgnoreNew;\n                    td.Settings.WakeToRun = true;\n                    td.Settings.StartWhenAvailable = true;\n                    //td.Settings.Priority = ProcessPriorityClass.High;\n                    td.Principal.RunLevel = TaskRunLevel.Highest;\n                    td.Principal.LogonType = TaskLogonType.InteractiveToken;\n\n\n\n                    // Create a trigger that will fire the task at this time every other day\n                    td.Triggers.Add(new LogonTrigger { });\n\n\n                    // Create an action that will launch Notepad whenever the trigger fires\n                    td.Actions.Add(new ExecAction(pathToApp, null, null));\n                    Debugger.Launch();\n                    // Register the task in the root folder\n                    ts.RootFolder.RegisterTaskDefinition(&quot;MyCustomTask&quot;, td);\n\n\n                    //Remove the task we just created\n                    //ts.RootFolder.DeleteTask(&quot;MyApp&quot;);\n                }</code></pre>\n\nWhat I actually want is to run the wix setup package (=MSI) under elevated permissions (Administrator).\r<br />\nWhen I use an CustomAction configured as &quot;immediate&quot; execute the MSI from an elevated console, then it works, but not on double click.\r<br />\n<br />\nSo I configured the CA as deferred, as I read somewhere, so that it will be automagically be executed in Admin-Mode. The UAC prompt pops up, but I get the above error:\r<br />\n<br />\n<strong>&quot;No mapping between account names and security IDs was done&quot;</strong>\r<br />\n<br />\nAny idea, what's wrong?<br />\n",
    "PostedDate": "2014-05-01T06:19:32.87-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]