[
  {
    "Id": "536307",
    "ThreadId": "238506",
    "Html": "\r\n<p>Hi,</p>\r\n<p>When I run the following code (WinXP SP3, .NET 3.5), I always get two schedules: one at DateTime.Now to run daily with no end date, and another with the expected start and end dates to run once instead of daily.&nbsp;I am trying to get a task that runs daily\r\n starting tomorrow for 7 days... just one schedule.</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TaskService ts =\r\n<span style=\"color:blue\">new</span> TaskService();<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Version ver = ts.HighestSupportedVersion;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">\r\nbool</span> newVer = (ver &gt;= <span style=\"color:blue\">new</span> Version(1, 2));<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TaskDefinition td = ts.NewTask();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; td.RegistrationInfo.Description =\r\n<span style=\"color:#a31515\">&quot;Task Description&quot;</span>;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">\r\nif</span> (newVer) td.Principal.RunLevel = TaskRunLevel.Highest;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; td.Principal.UserId =\r\n<span style=\"color:#a31515\">&quot;System&quot;</span>; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; td.Principal.LogonType = TaskLogonType.ServiceAccount;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DateTime start = DateTime.Today.AddDays(1.0d);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TimeTrigger tTrigger = (TimeTrigger)td.Triggers.Add(<span style=\"color:blue\">new</span> TimeTrigger(start));<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tTrigger.EndBoundary = DateTime.Today.AddDays(7.0d);<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; td.Triggers.Add(<span style=\"color:blue\">new</span> DailyTrigger(1));<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; td.Actions.Add(<span style=\"color:blue\">new</span> ExecAction(<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<span style=\"color:#a31515\">&quot;notepad.exe&quot;</span>,<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<span style=\"color:#a31515\">&quot;c:\\\\file.txt&quot;</span>,<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<span style=\"color:blue\">null</span>));<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ts.RootFolder.RegisterTaskDefinition(<span style=\"color:#a31515\">&quot;TaskName&quot;</span>, td);</p>\r\n<p>I am not sure how I am creating multiple schedules. Can you tell me what I am doing wrong?</p>\r\n<p>Thanks so much!</p>\r\n",
    "PostedDate": "2010-12-15T11:52:21.13-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "536449",
    "ThreadId": "238506",
    "Html": "\r\n<p>You are adding (Triggers.Add) two different triggers: A TimeTrigger which will fire once on the next day at midnight and a DailyTrigger which will run every day indefinitely at the time you run the code. I believe the following code will accomplish what\r\n you need. Replace all four lines associated with creating and adding triggers with the following line.</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>td.Triggers.Add(<span style=\"color:blue\">new</span> DailyTrigger { StartBoundary = DateTime.Now.AddDays(1), EndBoundary = DateTime.Now.AddDays(8) });</pre>\r\n</div>\r\n",
    "PostedDate": "2010-12-15T15:00:34.35-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]